在代码中，我们按品类的缺失数据量比例，将填补方案划分为三类，具体方法如下：

### 1. **时间序列插值**：适用于缺失数据量较少的品类（缺失数据点 ≤ 18，即缺失数据量占比低于 10%）

- **方法**：使用线性插值（`interpolate`），根据时间序列的前后数据点线性地填补缺失值。
- **适用品类**：缺失数据点少，且数据的连续性较强，趋势较平稳的品类。线性插值方法会在缺失点的前后数据基础上估算该点的值。
- **优势**：保持数据的时间序列趋势，避免明显波动，适合缺失量较少的品类数据。

### 2. **基于相关品类的加权填补**：适用于缺失数据量中等的品类（缺失数据点 > 18 且 ≤ 90，即缺失数据量占比在 10%-50%之间）

- **方法**：
  1.  **计算相关性**：首先通过相关性矩阵，计算出该品类与其他品类的相关性。
  2.  **选择参考品类**：选择与目标品类相关性最高的 5 个品类作为填补参考。
  3.  **加权平均**：根据相关性为每个参考品类赋予权重（相关性越高权重越大），然后对这些品类的销量数据进行加权平均，用于填补目标品类的缺失数据。
- **适用品类**：缺失数据量中等，且可以通过相关性较强的其他品类提供合理的趋势参考。
- **优势**：利用同一高级品类内的相关品类，确保填补后的数据符合总体趋势，特别适合存在相似销量模式的品类。

### 3. **移动均值填补**：适用于缺失数据量较多的品类（缺失数据点 > 90，即缺失数据量占比超过 50%）

- **方法**：采用 7 天窗口的简单移动平均（`rolling(window=7).mean()`），用相邻的 7 天数据计算均值填补缺失值。如果窗口内的数据不足，则以现有数据为准。
- **适用品类**：缺失数据量大，时间序列数据不足以直接插值，且没有明显的相关品类趋势可借鉴的品类。
- **优势**：移动均值填补可以提供平滑、稳定的估算值，适合缺失量大、且短期数据波动大的情况，能生成平稳的数据序列。

### 4. **特殊情况处理：极少数据的品类**

- 对于极少数据（少于 10 条）的品类，考虑利用 **高级品类的均值填补**，基于同一高级品类内其他品类的销量均值进行填补。
- 适合数据极度缺失、无法直接使用时间序列或相关性填补的情况，为数据严重不足的品类提供基准填补值。

### 小结

这种方案确保了数据的完整性，兼顾了时间序列的连续性和相关品类的模式。每种方法都根据品类的缺失情况选择了合适的填补策略，从而在尽量保留数据趋势的前提下填补缺失值。
